---
title: "finalexam"
author: "eternity"
date: "`r Sys.Date()`"
output: 
   
  html_document: 
    toc: yes
    highlight: textmate
    theme: cosmo
    toc_depth: 3
    toc_float: yes
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=F)
#install.packages("data.table",repos="http://cran.us.r-project.org")
library(data.table)
#install.packages("jstable",repos="http://cran.us.r-project.org")
library(jstable)
```

## Table1 만들기

아래처럼 데이터 읽은 후, Q_로 시작하는 변수를 범주형으로 바꾼 후, 연도별 기술통계량을 Table로 나타내어라
(`jstable::CreateTableOneJS`이용)

```{r}
a<- fread("https://raw.githubusercontent.com/jinseob2kim/lecture-snuhlab/master/data/example_g1e.csv")

vars.factor <- grep("Q_",names(a),value=T)

for (v in vars.factor){
  a[[v]] <- factor(a[[v]])
}

vars.tb1 <- names(a)[-c(1:3)]

tb1 <- CreateTableOneJS(vars=vars.tb1,strata="EXMD_BZ_YYYY",data=a)

#knitr::kable(tb1$table,caption=tb1$caption)

#install.packages("DT")

DT::datatable(tb1$table,caption=tb1$caption)

```
## 회귀분석

### 선형회귀분석

time ~ rx + age + sex 선형 회귀 실행 후 Table 로 나타내어라. (`jstable::glmshow.display` 이용)

```{r}
library(survival)
#colon
res.reg <- glm(time ~ rx + age + sex, data=colon)

tb.reg <- glmshow.display(res.reg)

knitr::kable(tb.reg$table,caption = tb.reg$first.line)

```
### 로지스틱

status ~ rx + age + sex 로지스틱 회귀 실행 후 Table 로 나타내어라. (`jstable::glmshow.display` 이용)

```{r}
library(survival)
#colon
res.logistic <- glm(status ~ rx + age + sex, data=colon, family = binomial)

tb.logistic <- glmshow.display(res.logistic)

knitr::kable(res.logistic$table,caption = res.logistic$first.line)

```


### 생존분석

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
